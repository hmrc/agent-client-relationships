{
    "microservice": "agent-client-relationships",
    "controller": "StrideClientDetailsController",
    "apis": [
        {
            "endpoint": "POST /stride/active-relationships",
            "description": "Allows a Stride user to retrieve a list of active client relationships for a given set of client identifiers.",
            "interactions": [
                {
                    "step": 1,
                    "type": "Database",
                    "service": null,
                    "method": null,
                    "path": null,
                    "database": "agent-client-relationships-db (relationships)",
                    "operation": "Read",
                    "description": "Find all active relationships for the provided list of clients."
                },
                {
                    "step": 2,
                    "type": "API Call",
                    "service": "agent-assurance",
                    "method": "GET",
                    "path": "/agent-assurance/agent-details/:arn",
                    "database": null,
                    "operation": null,
                    "description": "Get details for each agent found in the relationships."
                }
            ]
        },
        {
            "endpoint": "GET /stride/client-details/service/:service/client/:clientIdType/:clientId",
            "description": "Allows a Stride user to retrieve comprehensive details for a client, including any active relationships.",
            "interactions": [
                {
                    "step": 1,
                    "type": "API Call",
                    "service": "des",
                    "method": "GET",
                    "path": "/registration/business-details/nino/:nino or /vat/customer/vrn/:vrn",
                    "database": null,
                    "operation": null,
                    "description": "Get client's business details from DES."
                },
                {
                    "step": 2,
                    "type": "Database",
                    "service": null,
                    "method": null,
                    "path": null,
                    "database": "agent-client-relationships-db (relationships)",
                    "operation": "Read",
                    "description": "Find any active relationships for the client."
                },
                {
                    "step": 3,
                    "type": "API Call",
                    "service": "agent-assurance",
                    "method": "GET",
                    "path": "/agent-assurance/agent-details/:arn",
                    "database": null,
                    "operation": null,
                    "description": "If a relationship exists, get details for the associated agent."
                }
            ]
        },
        {
            "endpoint": "GET /stride/irv-relationships/:nino",
            "description": "Allows a Stride user to retrieve active IRV (Income Record Viewer) relationships for a client's NINO.",
            "interactions": [
                {
                    "step": 1,
                    "type": "API Call",
                    "service": "agent-fi-relationship",
                    "method": "GET",
                    "path": "/agent-fi-relationship/irv-active-relationship/client/:nino",
                    "database": null,
                    "operation": null,
                    "description": "Find active IRV relationships from agent-fi-relationship."
                },
                {
                    "step": 2,
                    "type": "API Call",
                    "service": "agent-assurance",
                    "method": "GET",
                    "path": "/agent-assurance/agent-details/:arn",
                    "database": null,
                    "operation": null,
                    "description": "Get details for each agent found in the relationships."
                }
            ]
        }
    ]
}