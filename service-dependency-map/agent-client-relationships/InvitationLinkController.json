{
    "microservice": "agent-client-relationships",
    "controller": "InvitationLinkController",
    "apis": [
        {
            "endpoint": "GET /agent/agent-reference/uid/:uid/:normalizedAgentName",
            "description": "Validates an agent's invitation link using a unique ID and a normalized version of the agent's name.",
            "interactions": [
                {
                    "step": 1,
                    "type": "Database",
                    "service": null,
                    "method": null,
                    "path": null,
                    "database": "agent-client-relationships-db (agent-reference)",
                    "operation": "Read",
                    "description": "Find agent reference record by UID."
                },
                {
                    "step": 2,
                    "type": "API Call",
                    "service": "agent-assurance",
                    "method": "GET",
                    "path": "/agent-assurance/agent-details/:arn",
                    "database": null,
                    "operation": null,
                    "description": "Get agent details to check for suspension."
                }
            ]
        },
        {
            "endpoint": "GET /agent/agent-link",
            "description": "Creates a unique, shareable invitation link for the authenticated agent.",
            "interactions": [
                {
                    "step": 1,
                    "type": "Database",
                    "service": null,
                    "method": null,
                    "path": null,
                    "database": "agent-client-relationships-db (agent-reference)",
                    "operation": "Create",
                    "description": "Create a new agent reference record with a unique ID."
                }
            ]
        },
        {
            "endpoint": "POST /client/validate-invitation",
            "description": "Allows a client to validate an invitation they have received, checking for existing relationships or other pending invitations.",
            "interactions": [
                {
                    "step": 1,
                    "type": "Database",
                    "service": null,
                    "method": null,
                    "path": null,
                    "database": "agent-client-relationships-db (invitations)",
                    "operation": "Read",
                    "description": "Check for existing pending invitations for the client and service."
                },
                {
                    "step": 2,
                    "type": "API Call",
                    "service": "enrolment-store-proxy",
                    "method": "GET",
                    "path": "/enrolment-store-proxy/enrolment-store/enrolments/:enrolmentKey/groups",
                    "database": null,
                    "operation": null,
                    "description": "Check for an existing relationship in the enrolment store."
                }
            ]
        }
    ]
}