{
    "microservice": "agent-client-relationships",
    "controller": "ApiCreateInvitationController",
    "apis": [
        {
            "endpoint": "POST /api/:arn/invitation",
            "description": "Creates an authorisation request (invitation) via the API, performing extensive validation.",
            "interactions": [
                {
                    "step": 1,
                    "type": "Database",
                    "service": null,
                    "method": null,
                    "path": null,
                    "database": "agent-client-relationships-db (invitations)",
                    "operation": "Read",
                    "description": "Check for existing pending invitations for the same agent, client, and service."
                },
                {
                    "step": 2,
                    "type": "API Call",
                    "service": "agent-assurance",
                    "method": "GET",
                    "path": "/agent-assurance/agent-details/:arn",
                    "database": null,
                    "operation": null,
                    "description": "Check if the agent is non-suspended."
                },
                {
                    "step": 3,
                    "type": "API Call",
                    "service": "des",
                    "method": "GET",
                    "path": "/registration/business-details/... or /vat/customer/vrn/...",
                    "database": null,
                    "operation": null,
                    "description": "Find client details from DES to validate known facts."
                },
                {
                    "step": 4,
                    "type": "Database",
                    "service": null,
                    "method": null,
                    "path": null,
                    "database": "agent-client-relationships-db (relationships)",
                    "operation": "Read",
                    "description": "Check for an existing active relationship."
                },
                {
                    "step": 5,
                    "type": "Database",
                    "service": null,
                    "method": null,
                    "path": null,
                    "database": "agent-client-relationships-db (partial-auth)",
                    "operation": "Read",
                    "description": "For ITSA, check for an existing partial-auth relationship."
                },
                {
                    "step": 6,
                    "type": "Database",
                    "service": null,
                    "method": null,
                    "path": null,
                    "database": "agent-client-relationships-db (invitations)",
                    "operation": "Create",
                    "description": "Create the new invitation record."
                }
            ]
        }
    ]
}